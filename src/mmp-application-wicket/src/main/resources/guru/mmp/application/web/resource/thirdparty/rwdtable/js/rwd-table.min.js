!function(t){"use strict";function e(){return"undefined"!=typeof window.matchMedia||"undefined"!=typeof window.msMatchMedia||"undefined"!=typeof window.styleMedia}function i(){return"ontouchstart"in window}function a(){return!!(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i))}var s=function(e,i){var s=this;if(this.options=i,this.$tableWrapper=null,this.$tableScrollWrapper=t(e),this.$table=t(e).find("table"),1!==this.$table.length)throw new Error("Exactly one table is expected in a .table-responsive div.");this.$tableScrollWrapper.attr("data-pattern",this.options.pattern),this.id=this.$table.prop("id")||this.$tableScrollWrapper.prop("id")||"id"+Math.random().toString(16).slice(2),this.$tableClone=null,this.$stickyTableHeader=null,this.$thead=this.$table.find("thead"),this.$tbody=this.$table.find("tbody"),this.$hdrCells=this.$thead.find("th"),this.$bodyRows=this.$tbody.find("tr"),this.$btnToolbar=null,this.$dropdownGroup=null,this.$dropdownBtn=null,this.$dropdownContainer=null,this.$displayAllBtn=null,this.$focusGroup=null,this.$focusBtn=null,this.displayAllTrigger="display-all-"+this.id+".responsive-table",this.idPrefix=this.id+"-col-",this.iOS=a(),this.wrapTable(),this.createButtonToolbar(),this.setupHdrCells(),this.setupStandardCells(),this.options.stickyTableHeader&&this.createStickyTableHeader(),this.$dropdownContainer.is(":empty")&&this.$dropdownGroup.hide(),t(window).bind("orientationchange resize "+this.displayAllTrigger,function(){s.$dropdownContainer.find("input").trigger("updateCheck"),t.proxy(s.updateSpanningCells(),s)})};s.DEFAULTS={pattern:"priority-columns",stickyTableHeader:!0,fixedNavbar:".navbar-fixed-top",addDisplayAllBtn:!0,addFocusBtn:!0,focusBtnIcon:"glyphicon glyphicon-screenshot"},s.prototype.wrapTable=function(){this.$tableScrollWrapper.wrap('<div class="table-wrapper"/>'),this.$tableWrapper=this.$tableScrollWrapper.parent()},s.prototype.createButtonToolbar=function(){var e=this;this.$btnToolbar=t('<div class="btn-toolbar" />'),this.$dropdownGroup=t('<div class="btn-group dropdown-btn-group pull-right" />'),this.$dropdownBtn=t('<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">Display <span class="caret"></span></button>'),this.$dropdownContainer=t('<ul class="dropdown-menu"/>'),this.options.addFocusBtn&&(this.$focusGroup=t('<div class="btn-group focus-btn-group" />'),this.$focusBtn=t('<button class="btn btn-default">Focus</button>'),this.options.focusBtnIcon&&this.$focusBtn.prepend('<span class="'+this.options.focusBtnIcon+'"></span> '),this.$focusGroup.append(this.$focusBtn),this.$btnToolbar.append(this.$focusGroup),this.$focusBtn.click(function(){t.proxy(e.activateFocus(),e)}),this.$bodyRows.click(function(){t.proxy(e.focusOnRow(t(this)),e)})),this.options.addDisplayAllBtn&&(this.$displayAllBtn=t('<button class="btn btn-default">Display all</button>'),this.$dropdownGroup.append(this.$displayAllBtn),this.$table.hasClass("display-all")&&this.$displayAllBtn.addClass("btn-primary"),this.$displayAllBtn.click(function(){t.proxy(e.displayAll(null,!0),e)})),this.$dropdownGroup.append(this.$dropdownBtn).append(this.$dropdownContainer),this.$btnToolbar.append(this.$dropdownGroup),this.$tableScrollWrapper.before(this.$btnToolbar)},s.prototype.clearAllFocus=function(){this.$bodyRows.removeClass("unfocused"),this.$bodyRows.removeClass("focused")},s.prototype.activateFocus=function(){this.clearAllFocus(),this.$focusBtn&&this.$focusBtn.toggleClass("btn-primary"),this.$table.toggleClass("focus-on")},s.prototype.focusOnRow=function(e){if(this.$table.hasClass("focus-on")){var i=t(e).hasClass("focused");this.clearAllFocus(),i||(this.$bodyRows.addClass("unfocused"),t(e).addClass("focused"))}},s.prototype.displayAll=function(e,i){this.$displayAllBtn&&this.$displayAllBtn.toggleClass("btn-primary",e),this.$table.toggleClass("display-all",e),this.$tableClone&&this.$tableClone.toggleClass("display-all",e),i&&t(window).trigger(this.displayAllTrigger)},s.prototype.preserveDisplayAll=function(){var e="table-cell";t("html").hasClass("lt-ie9")&&(e="inline"),t(this.$table).find("th, td").css("display",e),this.$tableClone&&t(this.$tableClone).find("th, td").css("display",e)},s.prototype.createStickyTableHeader=function(){var e=this;e.$tableClone=e.$table.clone(),e.$tableClone.prop("id",this.id+"-clone"),e.$tableClone.find("[id]").each(function(){t(this).prop("id",t(this).prop("id")+"-clone")}),e.$tableClone.wrap('<div class="sticky-table-header"/>'),e.$stickyTableHeader=e.$tableClone.parent(),e.$stickyTableHeader.css("height",e.$thead.height()+2),t("html").hasClass("lt-ie10")?e.$tableWrapper.prepend(e.$stickyTableHeader):e.$table.before(e.$stickyTableHeader),t(window).bind("scroll resize",function(){t.proxy(e.updateStickyTableHeader(),e)}),t(e.$tableScrollWrapper).bind("scroll",function(){t.proxy(e.updateStickyTableHeader(),e)})},s.prototype.updateStickyTableHeader=function(){var e=this,i=0,a=e.$table.offset().top,s=t(window).scrollTop()-1,o=e.$table.height()-e.$stickyTableHeader.height(),l=s+t(window).height()-t(document).height(),n=!e.iOS,r=0;if(t(e.options.fixedNavbar).length){var p=t(e.options.fixedNavbar).first();r=p.height(),s+=r}var d=s>a&&s<a+e.$table.height();if(n){if(e.$stickyTableHeader.scrollLeft(e.$tableScrollWrapper.scrollLeft()),e.$stickyTableHeader.addClass("fixed-solution"),i=r-1,s-a>o?(i-=s-a-o,e.$stickyTableHeader.addClass("border-radius-fix")):e.$stickyTableHeader.removeClass("border-radius-fix"),d)return void e.$stickyTableHeader.css({visibility:"visible",top:i+"px",width:e.$tableScrollWrapper.innerWidth()+"px"});e.$stickyTableHeader.css({visibility:"hidden",width:"auto"})}else{e.$stickyTableHeader.removeClass("fixed-solution");var c=400;i=s-a-1,0>i?i=0:i>o&&(i=o),l>0&&(i-=l),d?(e.$stickyTableHeader.css({visibility:"visible"}),e.$stickyTableHeader.animate({top:i+"px"},c),e.$thead.css({visibility:"hidden"})):e.$stickyTableHeader.animate({top:"0"},c,function(){e.$thead.css({visibility:"visible"}),e.$stickyTableHeader.css({visibility:"hidden"})})}},s.prototype.setupHdrCells=function(){var e=this;e.$hdrCells.each(function(i){var a=t(this),s=a.prop("id"),o=a.text();if(s||(s=e.idPrefix+i,a.prop("id",s)),""===o&&(o=a.attr("data-col-name")),a.is("[data-priority]")){var l=t('<li class="checkbox-row"><input type="checkbox" name="toggle-'+s+'" id="toggle-'+s+'" value="'+s+'" /> <label for="toggle-'+s+'">'+o+"</label></li>"),n=l.find("input");e.$dropdownContainer.append(l),l.click(function(){n.prop("checked",!n.prop("checked")),n.trigger("change")}),t("html").hasClass("lt-ie9")&&n.click(function(){t(this).trigger("change")}),l.find("label").click(function(t){t.stopPropagation()}),l.find("input").click(function(t){t.stopPropagation()}).change(function(){var i=t(this),a=i.val(),s=e.$tableWrapper.find("#"+a+", #"+a+"-clone, [data-columns~="+a+"]");e.$table.hasClass("display-all")&&(t.proxy(e.preserveDisplayAll(),e),e.$table.removeClass("display-all"),e.$tableClone&&e.$tableClone.removeClass("display-all"),e.$displayAllBtn.removeClass("btn-primary")),s.each(function(){var e=t(this);i.is(":checked")?("none"!==e.css("display")&&e.prop("colSpan",parseInt(e.prop("colSpan"))+1),e.show()):parseInt(e.prop("colSpan"))>1?e.prop("colSpan",parseInt(e.prop("colSpan"))-1):e.hide()})}).bind("updateCheck",function(){"none"!==a.css("display")?t(this).prop("checked",!0):t(this).prop("checked",!1)}).trigger("updateCheck")}})},s.prototype.setupStandardCells=function(){var e=this;e.$bodyRows.each(function(){var i=0;t(this).find("th, td").each(function(){for(var a=t(this),s="",o=a.prop("colSpan"),l=0,n=i;i+o>n;n++){s=s+" "+e.idPrefix+n;var r=e.$tableScrollWrapper.find("#"+e.idPrefix+n),p=r.attr("data-priority");p&&a.attr("data-priority",p),"none"===r.css("display")&&l++}o>1&&(a.addClass("spn-cell"),l!==o?a.show():a.hide()),a.prop("colSpan",Math.max(o-l,1)),s=s.substring(1),a.attr("data-columns",s),i+=o})})},s.prototype.updateSpanningCells=function(){var e=this;e.$table.find(".spn-cell").each(function(){for(var e=t(this),i=e.attr("data-columns").split(" "),a=i.length,s=0,o=0;a>o;o++)"none"===t("#"+i[o]).css("display")&&s++;s!==a?e.show():e.hide(),e.prop("colSpan",Math.max(a-s,1))})};var o=t.fn.responsiveTable;t.fn.responsiveTable=function(e){return this.each(function(){var i=t(this),a=i.data("responsiveTable"),o=t.extend({},s.DEFAULTS,i.data(),"object"==typeof e&&e);""!==o.pattern&&(a||i.data("responsiveTable",a=new s(this,o)),"string"==typeof e&&a[e]())})},t.fn.responsiveTable.Constructor=s,t.fn.responsiveTable.noConflict=function(){return t.fn.responsiveTable=o,this},t(document).on("ready.responsive-table.data-api",function(){t("[data-pattern]").each(function(){var e=t(this);e.responsiveTable(e.data())})}),t(document).on("click.dropdown.data-api",".dropdown-menu .checkbox-row",function(t){t.stopPropagation()}),t(document).ready(function(){t("html").removeClass("no-js").addClass("js"),t("html").addClass(e()?"mq":"no-mq"),t("html").addClass(i()?"touch":"no-touch")})}(jQuery);